<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings</a>
<a id="117" class="Comment">------------------------------------------------------------------------</a>

<a id="191" class="Symbol">{-#</a> <a id="195" class="Keyword">OPTIONS</a> <a id="203" class="Pragma">--cubical-compatible</a> <a id="224" class="Pragma">--safe</a> <a id="231" class="Symbol">#-}</a>

<a id="236" class="Keyword">module</a> <a id="243" href="Data.String.html" class="Module">Data.String</a> <a id="255" class="Keyword">where</a>

<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="284" class="Keyword">using</a> <a id="290" class="Symbol">(</a><a id="291" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="295" class="Symbol">;</a> <a id="297" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="302" class="Symbol">;</a> <a id="304" href="Data.Bool.Properties.html#16383" class="Function">T?</a><a id="306" class="Symbol">)</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Data.Char.html" class="Module">Data.Char</a> <a id="330" class="Symbol">as</a> <a id="333" class="Module">Char</a> <a id="338" class="Keyword">using</a> <a id="344" class="Symbol">(</a><a id="345" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="349" class="Symbol">)</a>
<a id="351" class="Keyword">open</a> <a id="356" class="Keyword">import</a> <a id="363" href="Function.Base.html" class="Module">Function.Base</a>
<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="403" class="Symbol">as</a> <a id="406" class="Module">ℕ</a> <a id="408" class="Keyword">using</a> <a id="414" class="Symbol">(</a><a id="415" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="416" class="Symbol">;</a> <a id="418" href="Data.Nat.Base.html#3211" class="Primitive Operator">_∸_</a><a id="421" class="Symbol">;</a> <a id="423" href="Data.Nat.Base.html#4362" class="Function Operator">⌊_/2⌋</a><a id="428" class="Symbol">;</a> <a id="430" href="Data.Nat.Base.html#4489" class="Function Operator">⌈_/2⌉</a><a id="435" class="Symbol">)</a>
<a id="437" class="Keyword">import</a> <a id="444" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="464" class="Symbol">as</a> <a id="467" class="Module">ℕₚ</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="497" class="Symbol">as</a> <a id="500" class="Module">List</a> <a id="505" class="Keyword">using</a> <a id="511" class="Symbol">(</a><a id="512" href="Agda.Builtin.List.html#130" class="Datatype">List</a><a id="516" class="Symbol">;</a> <a id="518" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">_∷_</a><a id="521" class="Symbol">;</a> <a id="523" href="Data.List.Base.html#7370" class="InductiveConstructor">[]</a><a id="525" class="Symbol">;</a> <a id="527" href="Data.List.Base.html#5228" class="Function Operator">[_]</a><a id="530" class="Symbol">)</a>
<a id="532" class="Keyword">open</a> <a id="537" class="Keyword">import</a> <a id="544" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="563" class="Symbol">as</a> <a id="566" class="Module">NE</a> <a id="569" class="Keyword">using</a> <a id="575" class="Symbol">(</a><a id="576" href="Data.List.NonEmpty.Base.html#1276" class="Record">List⁺</a><a id="581" class="Symbol">)</a>
<a id="583" class="Keyword">open</a> <a id="588" class="Keyword">import</a> <a id="595" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="613" href="Data.Nat.Properties.html#7148" class="Function">ℕₚ.≤-totalOrder</a>
<a id="629" class="Keyword">open</a> <a id="634" class="Keyword">import</a> <a id="641" href="Data.List.Relation.Binary.Pointwise.html" class="Module">Data.List.Relation.Binary.Pointwise</a> <a id="677" class="Keyword">using</a> <a id="683" class="Symbol">(</a><a id="684" href="Data.List.Relation.Binary.Pointwise.Base.html#784" class="Datatype">Pointwise</a><a id="693" class="Symbol">)</a>
<a id="695" class="Keyword">open</a> <a id="700" class="Keyword">import</a> <a id="707" href="Data.List.Relation.Binary.Lex.Strict.html" class="Module">Data.List.Relation.Binary.Lex.Strict</a> <a id="744" class="Keyword">using</a> <a id="750" class="Symbol">(</a><a id="751" href="Data.List.Relation.Binary.Lex.Core.html#1517" class="Function">Lex-&lt;</a><a id="756" class="Symbol">;</a> <a id="758" href="Data.List.Relation.Binary.Lex.Core.html#1623" class="Function">Lex-≤</a><a id="763" class="Symbol">)</a>
<a id="765" class="Keyword">open</a> <a id="770" class="Keyword">import</a> <a id="777" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="791" class="Symbol">as</a> <a id="794" class="Module">Vec</a> <a id="798" class="Keyword">using</a> <a id="804" class="Symbol">(</a><a id="805" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a><a id="808" class="Symbol">)</a>
<a id="810" class="Keyword">open</a> <a id="815" class="Keyword">import</a> <a id="822" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="837" class="Symbol">as</a> <a id="840" class="Module">Char</a> <a id="845" class="Keyword">using</a> <a id="851" class="Symbol">(</a><a id="852" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="856" class="Symbol">)</a>
<a id="858" class="Keyword">import</a> <a id="865" href="Data.Char.Properties.html" class="Module">Data.Char.Properties</a> <a id="886" class="Symbol">as</a> <a id="889" class="Module">Char</a> <a id="894" class="Keyword">using</a> <a id="900" class="Symbol">(</a><a id="901" href="Data.Char.Properties.html#1499" class="Function Operator">_≟_</a><a id="904" class="Symbol">)</a>
<a id="906" class="Keyword">open</a> <a id="911" class="Keyword">import</a> <a id="918" href="Function.html" class="Module">Function</a>
<a id="927" class="Keyword">open</a> <a id="932" class="Keyword">import</a> <a id="939" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="955" class="Keyword">using</a> <a id="961" class="Symbol">(</a><a id="962" href="Relation.Binary.Core.html#891" class="Function">Rel</a><a id="965" class="Symbol">)</a>
<a id="967" class="Keyword">open</a> <a id="972" class="Keyword">import</a> <a id="979" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1017" class="Keyword">using</a> <a id="1023" class="Symbol">(</a><a id="1024" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="1027" class="Symbol">;</a> <a id="1029" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="1033" class="Symbol">)</a>
<a id="1035" class="Keyword">open</a> <a id="1040" class="Keyword">import</a> <a id="1047" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1074" class="Keyword">using</a> <a id="1080" class="Symbol">(</a><a id="1081" href="Relation.Nullary.Decidable.Core.html#1555" class="Field">does</a><a id="1085" class="Symbol">)</a>
<a id="1087" class="Keyword">open</a> <a id="1092" class="Keyword">import</a> <a id="1099" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="1114" class="Keyword">using</a> <a id="1120" class="Symbol">(</a><a id="1121" href="Relation.Unary.html#1120" class="Function">Pred</a><a id="1125" class="Symbol">;</a> <a id="1127" href="Relation.Unary.html#3694" class="Function">Decidable</a><a id="1136" class="Symbol">)</a>

<a id="1139" class="Keyword">open</a> <a id="1144" class="Keyword">import</a> <a id="1151" href="Data.List.Membership.DecPropositional.html" class="Module">Data.List.Membership.DecPropositional</a> <a id="1189" href="Data.Char.Properties.html#1499" class="Function Operator">Char._≟_</a>



<a id="1201" class="Comment">------------------------------------------------------------------------</a>
<a id="1274" class="Comment">-- Re-export contents of base, and decidability of equality</a>

<a id="1335" class="Keyword">open</a> <a id="1340" class="Keyword">import</a> <a id="1347" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="1364" class="Keyword">public</a>
<a id="1371" class="Keyword">open</a> <a id="1376" class="Keyword">import</a> <a id="1383" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="1406" class="Keyword">using</a> <a id="1412" class="Symbol">(</a><a id="1413" href="Data.String.Properties.html#1614" class="Function Operator">_≈?_</a><a id="1417" class="Symbol">;</a> <a id="1419" href="Data.String.Properties.html#2294" class="Function Operator">_≟_</a><a id="1422" class="Symbol">;</a> <a id="1424" href="Data.String.Properties.html#2580" class="Function Operator">_&lt;?_</a><a id="1428" class="Symbol">;</a> <a id="1430" href="Data.String.Properties.html#4359" class="Function Operator">_==_</a><a id="1434" class="Symbol">)</a> <a id="1436" class="Keyword">public</a>

<a id="1444" class="Comment">------------------------------------------------------------------------</a>
<a id="1517" class="Comment">-- Conversion functions</a>

<a id="toVec"></a><a id="1542" href="Data.String.html#1542" class="Function">toVec</a> <a id="1548" class="Symbol">:</a> <a id="1550" class="Symbol">(</a><a id="1551" href="Data.String.html#1551" class="Bound">s</a> <a id="1553" class="Symbol">:</a> <a id="1555" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="1561" class="Symbol">)</a> <a id="1563" class="Symbol">→</a> <a id="1565" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="1569" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1574" class="Symbol">(</a><a id="1575" href="Data.String.Base.html#2487" class="Function">length</a> <a id="1582" href="Data.String.html#1551" class="Bound">s</a><a id="1583" class="Symbol">)</a>
<a id="1585" href="Data.String.html#1542" class="Function">toVec</a> <a id="1591" href="Data.String.html#1591" class="Bound">s</a> <a id="1593" class="Symbol">=</a> <a id="1595" href="Data.Vec.Base.html#8572" class="Function">Vec.fromList</a> <a id="1608" class="Symbol">(</a><a id="1609" href="Data.String.Base.html#1550" class="Primitive">toList</a> <a id="1616" href="Data.String.html#1591" class="Bound">s</a><a id="1617" class="Symbol">)</a>

<a id="fromVec"></a><a id="1620" href="Data.String.html#1620" class="Function">fromVec</a> <a id="1628" class="Symbol">:</a> <a id="1630" class="Symbol">∀</a> <a id="1632" class="Symbol">{</a><a id="1633" href="Data.String.html#1633" class="Bound">n</a><a id="1634" class="Symbol">}</a> <a id="1636" class="Symbol">→</a> <a id="1638" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="1642" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1647" href="Data.String.html#1633" class="Bound">n</a> <a id="1649" class="Symbol">→</a> <a id="1651" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1658" href="Data.String.html#1620" class="Function">fromVec</a> <a id="1666" class="Symbol">=</a> <a id="1668" href="Data.String.Base.html#1583" class="Primitive">fromList</a> <a id="1677" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1679" href="Data.Vec.Base.html#8478" class="Function">Vec.toList</a>


<a id="1692" class="Comment">-- enclose string with parens if it contains a space character</a>
<a id="parensIfSpace"></a><a id="1755" href="Data.String.html#1755" class="Function">parensIfSpace</a> <a id="1769" class="Symbol">:</a> <a id="1771" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1778" class="Symbol">→</a> <a id="1780" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1787" href="Data.String.html#1755" class="Function">parensIfSpace</a> <a id="1801" href="Data.String.html#1801" class="Bound">s</a> <a id="1803" class="Keyword">with</a> <a id="1808" href="Relation.Nullary.Decidable.Core.html#1555" class="Field">does</a> <a id="1813" class="Symbol">(</a><a id="1814" class="String">&#39; &#39;</a> <a id="1818" href="Data.List.Membership.DecSetoid.html#827" class="Function Operator">∈?</a> <a id="1821" href="Data.String.Base.html#1550" class="Primitive">toList</a> <a id="1828" href="Data.String.html#1801" class="Bound">s</a><a id="1829" class="Symbol">)</a>
<a id="1831" class="Symbol">...</a> <a id="1835" class="Symbol">|</a> <a id="1837" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>  <a id="1843" class="Symbol">=</a> <a id="1845" href="Data.String.Base.html#2883" class="Function">parens</a> <a id="1852" class="Bound">s</a>
<a id="1854" class="Symbol">...</a> <a id="1858" class="Symbol">|</a> <a id="1860" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a> <a id="1866" class="Symbol">=</a> <a id="1868" class="Bound">s</a>


<a id="1872" class="Comment">------------------------------------------------------------------------</a>
<a id="1945" class="Comment">-- Rectangle</a>

<a id="1959" class="Comment">-- Build a rectangular column by:</a>
<a id="1993" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="2056" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="2124" href="Data.String.html#2124" class="Function">rectangle</a> <a id="2134" class="Symbol">:</a> <a id="2136" class="Symbol">∀</a> <a id="2138" class="Symbol">{</a><a id="2139" href="Data.String.html#2139" class="Bound">n</a><a id="2140" class="Symbol">}</a> <a id="2142" class="Symbol">→</a> <a id="2144" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="2148" class="Symbol">(</a><a id="2149" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2151" class="Symbol">→</a> <a id="2153" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2160" class="Symbol">→</a> <a id="2162" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="2168" class="Symbol">)</a> <a id="2170" href="Data.String.html#2139" class="Bound">n</a> <a id="2172" class="Symbol">→</a>
            <a id="2186" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="2190" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2197" href="Data.String.html#2139" class="Bound">n</a> <a id="2199" class="Symbol">→</a> <a id="2201" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="2205" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2212" href="Data.String.html#2139" class="Bound">n</a>
<a id="2214" href="Data.String.html#2124" class="Function">rectangle</a> <a id="2224" href="Data.String.html#2224" class="Bound">pads</a> <a id="2229" href="Data.String.html#2229" class="Bound">cells</a> <a id="2235" class="Symbol">=</a> <a id="2237" href="Data.Vec.Base.html#3592" class="Function">Vec.zipWith</a> <a id="2249" class="Symbol">(λ</a> <a id="2252" href="Data.String.html#2252" class="Bound">p</a> <a id="2254" href="Data.String.html#2254" class="Bound">c</a> <a id="2256" class="Symbol">→</a> <a id="2258" href="Data.String.html#2252" class="Bound">p</a> <a id="2260" href="Data.String.html#2334" class="Function">width</a> <a id="2266" href="Data.String.html#2254" class="Bound">c</a><a id="2267" class="Symbol">)</a> <a id="2269" href="Data.String.html#2224" class="Bound">pads</a> <a id="2274" href="Data.String.html#2229" class="Bound">cells</a> <a id="2280" class="Keyword">where</a>

  <a id="2289" href="Data.String.html#2289" class="Function">sizes</a> <a id="2295" class="Symbol">=</a> <a id="2297" href="Data.List.Base.html#1615" class="Function">List.map</a> <a id="2306" href="Data.String.Base.html#2487" class="Function">length</a> <a id="2313" class="Symbol">(</a><a id="2314" href="Data.Vec.Base.html#8478" class="Function">Vec.toList</a> <a id="2325" href="Data.String.html#2229" class="Bound">cells</a><a id="2330" class="Symbol">)</a>
  <a id="2334" href="Data.String.html#2334" class="Function">width</a> <a id="2340" class="Symbol">=</a> <a id="2342" href="Data.List.Extrema.html#1945" class="Function">max</a> <a id="2346" class="Number">0</a> <a id="2348" href="Data.String.html#2289" class="Function">sizes</a>

<a id="2355" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="2411" href="Data.String.html#2411" class="Function">rectangleˡ</a> <a id="2422" class="Symbol">:</a> <a id="2424" class="Symbol">∀</a> <a id="2426" class="Symbol">{</a><a id="2427" href="Data.String.html#2427" class="Bound">n</a><a id="2428" class="Symbol">}</a> <a id="2430" class="Symbol">→</a> <a id="2432" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2437" class="Symbol">→</a> <a id="2439" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="2443" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2450" href="Data.String.html#2427" class="Bound">n</a> <a id="2452" class="Symbol">→</a> <a id="2454" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="2458" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2465" href="Data.String.html#2427" class="Bound">n</a>
<a id="2467" href="Data.String.html#2411" class="Function">rectangleˡ</a> <a id="2478" href="Data.String.html#2478" class="Bound">c</a> <a id="2480" class="Symbol">=</a> <a id="2482" href="Data.String.html#2124" class="Function">rectangle</a> <a id="2492" class="Symbol">(</a><a id="2493" href="Data.Vec.Base.html#6394" class="Function">Vec.replicate</a> <a id="2507" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2509" href="Data.String.Base.html#3615" class="Function">padLeft</a> <a id="2517" href="Data.String.html#2478" class="Bound">c</a><a id="2518" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="2521" href="Data.String.html#2521" class="Function">rectangleʳ</a> <a id="2532" class="Symbol">:</a> <a id="2534" class="Symbol">∀</a> <a id="2536" class="Symbol">{</a><a id="2537" href="Data.String.html#2537" class="Bound">n</a><a id="2538" class="Symbol">}</a> <a id="2540" class="Symbol">→</a> <a id="2542" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2547" class="Symbol">→</a> <a id="2549" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="2553" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2560" href="Data.String.html#2537" class="Bound">n</a> <a id="2562" class="Symbol">→</a> <a id="2564" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="2568" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2575" href="Data.String.html#2537" class="Bound">n</a>
<a id="2577" href="Data.String.html#2521" class="Function">rectangleʳ</a> <a id="2588" href="Data.String.html#2588" class="Bound">c</a> <a id="2590" class="Symbol">=</a> <a id="2592" href="Data.String.html#2124" class="Function">rectangle</a> <a id="2602" class="Symbol">(</a><a id="2603" href="Data.Vec.Base.html#6394" class="Function">Vec.replicate</a> <a id="2617" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2619" href="Data.String.Base.html#3734" class="Function">padRight</a> <a id="2628" href="Data.String.html#2588" class="Bound">c</a><a id="2629" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="2632" href="Data.String.html#2632" class="Function">rectangleᶜ</a> <a id="2643" class="Symbol">:</a> <a id="2645" class="Symbol">∀</a> <a id="2647" class="Symbol">{</a><a id="2648" href="Data.String.html#2648" class="Bound">n</a><a id="2649" class="Symbol">}</a> <a id="2651" class="Symbol">→</a> <a id="2653" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2658" class="Symbol">→</a> <a id="2660" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2665" class="Symbol">→</a> <a id="2667" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="2671" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2678" href="Data.String.html#2648" class="Bound">n</a> <a id="2680" class="Symbol">→</a> <a id="2682" href="Data.Vec.Base.html#1076" class="Datatype">Vec</a> <a id="2686" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2693" href="Data.String.html#2648" class="Bound">n</a>
<a id="2695" href="Data.String.html#2632" class="Function">rectangleᶜ</a> <a id="2706" href="Data.String.html#2706" class="Bound">cₗ</a> <a id="2709" href="Data.String.html#2709" class="Bound">cᵣ</a> <a id="2712" class="Symbol">=</a> <a id="2714" href="Data.String.html#2124" class="Function">rectangle</a> <a id="2724" class="Symbol">(</a><a id="2725" href="Data.Vec.Base.html#6394" class="Function">Vec.replicate</a> <a id="2739" href="Function.Base.html#2003" class="Function Operator">$</a> <a id="2741" href="Data.String.Base.html#3855" class="Function">padBoth</a> <a id="2749" href="Data.String.html#2706" class="Bound">cₗ</a> <a id="2752" href="Data.String.html#2709" class="Bound">cᵣ</a><a id="2754" class="Symbol">)</a>
</pre></body></html>