<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Theory.Soundness</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">import</a> <a id="8" href="Syntax.Simple.Signature.html" class="Module">Syntax.Simple.Signature</a>  <a id="33" class="Symbol">as</a> <a id="36" class="Module">S</a>
<a id="38" class="Keyword">import</a> <a id="45" href="Syntax.BiTyped.Signature.html" class="Module">Syntax.BiTyped.Signature</a> <a id="70" class="Symbol">as</a> <a id="73" class="Module">B</a>

<a id="76" class="Keyword">module</a> <a id="83" href="Theory.Soundness.html" class="Module">Theory.Soundness</a> <a id="100" class="Symbol">{</a><a id="101" href="Theory.Soundness.html#101" class="Bound">SD</a> <a id="104" class="Symbol">:</a> <a id="106" href="Syntax.Simple.Signature.html#97" class="Record">S.SigD</a><a id="112" class="Symbol">}</a> <a id="114" class="Symbol">(</a><a id="115" href="Theory.Soundness.html#115" class="Bound">BD</a> <a id="118" class="Symbol">:</a> <a id="120" href="Syntax.BiTyped.Signature.html#625" class="Record">B.SigD</a> <a id="127" href="Theory.Soundness.html#101" class="Bound">SD</a><a id="129" class="Symbol">)</a> <a id="131" class="Keyword">where</a>

<a id="138" class="Keyword">open</a> <a id="143" class="Keyword">import</a> <a id="150" href="Prelude.html" class="Module">Prelude</a>

<a id="159" class="Keyword">open</a> <a id="164" class="Keyword">import</a> <a id="171" href="Syntax.Simple.html" class="Module">Syntax.Simple</a>  <a id="186" href="Theory.Soundness.html#101" class="Bound">SD</a>
<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Syntax.Context.html" class="Module">Syntax.Context</a> <a id="216" href="Theory.Soundness.html#101" class="Bound">SD</a>
<a id="219" class="Keyword">open</a> <a id="224" href="Syntax.BiTyped.Signature.html" class="Module">B</a> <a id="226" href="Theory.Soundness.html#101" class="Bound">SD</a>

<a id="230" class="Keyword">open</a> <a id="235" class="Keyword">import</a> <a id="242" href="Syntax.BiTyped.Functor.html" class="Module">Syntax.BiTyped.Functor</a>   <a id="267" href="Theory.Soundness.html#101" class="Bound">SD</a>
<a id="270" class="Keyword">import</a>      <a id="282" href="Syntax.Typed.Functor.html" class="Module">Syntax.Typed.Functor</a>     <a id="307" href="Theory.Soundness.html#101" class="Bound">SD</a> as <a id="T"></a><a id="313" href="Theory.Soundness.html#313" class="Module">T</a>
<a id="315" class="Keyword">import</a>      <a id="327" href="Syntax.Typed.Raw.Functor.html" class="Module">Syntax.Typed.Raw.Functor</a> <a id="352" href="Theory.Soundness.html#101" class="Bound">SD</a> as <a id="R"></a><a id="358" href="Theory.Soundness.html#358" class="Module">R</a>

<a id="361" class="Keyword">open</a> <a id="366" class="Keyword">import</a> <a id="373" href="Theory.Erasure.html" class="Module">Theory.Erasure</a>

<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="Syntax.BiTyped.Term.html" class="Module">Syntax.BiTyped.Term</a>          <a id="430" href="Theory.Soundness.html#115" class="Bound">BD</a>
<a id="433" class="Keyword">open</a> <a id="438" class="Keyword">import</a> <a id="445" href="Syntax.Typed.Term.html" class="Module">Syntax.Typed.Term</a>     <a id="467" class="Symbol">(</a><a id="468" href="Theory.Erasure.html#392" class="Function">erase</a> <a id="474" href="Theory.Soundness.html#115" class="Bound">BD</a><a id="476" class="Symbol">)</a>
<a id="478" class="Keyword">open</a> <a id="483" class="Keyword">import</a> <a id="490" href="Syntax.Typed.Raw.Term.html" class="Module">Syntax.Typed.Raw.Term</a> <a id="512" class="Symbol">(</a><a id="513" href="Theory.Erasure.html#392" class="Function">erase</a> <a id="519" href="Theory.Soundness.html#115" class="Bound">BD</a><a id="521" class="Symbol">)</a>

<a id="524" class="Keyword">private</a> <a id="532" class="Keyword">variable</a>
  <a id="543" href="Theory.Soundness.html#543" class="Generalizable">Ξ</a> <a id="545" class="Symbol">:</a> <a id="547" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
  <a id="551" href="Theory.Soundness.html#551" class="Generalizable">Γ</a> <a id="553" class="Symbol">:</a> <a id="555" href="Syntax.Context.html#168" class="Function">Cxt</a> <a id="559" class="Number">0</a>
  <a id="563" href="Theory.Soundness.html#563" class="Generalizable">r</a> <a id="565" class="Symbol">:</a> <a id="567" href="Syntax.Typed.Raw.Term.html#286" class="Datatype">Raw</a> <a id="571" class="Symbol">_</a>
  <a id="575" href="Theory.Soundness.html#575" class="Generalizable">d</a> <a id="577" class="Symbol">:</a> <a id="579" href="Prelude.html#3643" class="Datatype">Mode</a>
  <a id="586" href="Theory.Soundness.html#586" class="Generalizable">A</a> <a id="588" class="Symbol">:</a> <a id="590" href="Syntax.Simple.html#170" class="Function">Ty</a>

<a id="594" class="Keyword">mutual</a>

  <a id="soundness"></a><a id="604" href="Theory.Soundness.html#604" class="Function">soundness</a> <a id="614" class="Symbol">:</a> <a id="616" href="Theory.Soundness.html#551" class="Generalizable">Γ</a> <a id="618" href="Syntax.BiTyped.Term.html#630" class="Datatype Operator">⊢</a> <a id="620" href="Theory.Soundness.html#563" class="Generalizable">r</a> <a id="622" href="Syntax.BiTyped.Term.html#630" class="Datatype Operator">[</a> <a id="624" href="Theory.Soundness.html#575" class="Generalizable">d</a> <a id="626" href="Syntax.BiTyped.Term.html#630" class="Datatype Operator">]</a> <a id="628" href="Theory.Soundness.html#586" class="Generalizable">A</a>  <a id="631" class="Symbol">→</a>  <a id="634" href="Theory.Soundness.html#551" class="Generalizable">Γ</a> <a id="636" href="Syntax.Typed.Term.html#434" class="Datatype Operator">⊢</a> <a id="638" href="Theory.Soundness.html#563" class="Generalizable">r</a> <a id="640" href="Syntax.Typed.Term.html#434" class="Datatype Operator">⦂</a> <a id="642" href="Theory.Soundness.html#586" class="Generalizable">A</a>
  <a id="646" href="Theory.Soundness.html#604" class="Function">soundness</a> <a id="656" class="Symbol">(</a><a id="657" href="Syntax.BiTyped.Term.html#660" class="InductiveConstructor">var</a> <a id="661" href="Theory.Soundness.html#661" class="Bound">i</a> <a id="663" href="Theory.Soundness.html#663" class="Bound">eq</a><a id="665" class="Symbol">)</a> <a id="667" class="Symbol">=</a> <a id="669" href="Syntax.Typed.Term.html#460" class="InductiveConstructor">var</a> <a id="673" href="Theory.Soundness.html#661" class="Bound">i</a> <a id="675" href="Theory.Soundness.html#663" class="Bound">eq</a>
  <a id="680" href="Theory.Soundness.html#604" class="Function">soundness</a> <a id="690" class="Symbol">(</a><a id="691" href="Theory.Soundness.html#691" class="Bound">A</a> <a id="693" href="Syntax.BiTyped.Term.html#793" class="InductiveConstructor Operator">∋</a> <a id="695" href="Theory.Soundness.html#695" class="Bound">t</a><a id="696" class="Symbol">)</a>    <a id="701" class="Symbol">=</a> <a id="703" href="Theory.Soundness.html#691" class="Bound">A</a> <a id="705" href="Syntax.Typed.Term.html#583" class="InductiveConstructor Operator">∋</a> <a id="707" href="Theory.Soundness.html#604" class="Function">soundness</a> <a id="717" href="Theory.Soundness.html#695" class="Bound">t</a>
  <a id="721" href="Theory.Soundness.html#604" class="Function">soundness</a> <a id="731" class="Symbol">(</a><a id="732" href="Theory.Soundness.html#732" class="Bound">t</a> <a id="734" href="Syntax.BiTyped.Term.html#859" class="InductiveConstructor Operator">↑</a> <a id="736" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="740" class="Symbol">)</a> <a id="742" class="Symbol">=</a> <a id="744" href="Theory.Soundness.html#604" class="Function">soundness</a> <a id="754" href="Theory.Soundness.html#732" class="Bound">t</a>
  <a id="758" href="Theory.Soundness.html#604" class="Function">soundness</a> <a id="768" class="Symbol">(</a><a id="769" href="Syntax.BiTyped.Term.html#936" class="InductiveConstructor">op</a> <a id="772" class="Symbol">{</a><a id="773" class="Argument">rs</a> <a id="776" class="Symbol">=</a> <a id="778" href="Theory.Soundness.html#778" class="Bound">i</a> <a id="780" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="782" class="Symbol">_}</a> <a id="785" class="Symbol">(_</a> <a id="788" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="790" href="Theory.Soundness.html#790" class="Bound">σ</a> <a id="792" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="794" href="Theory.Soundness.html#794" class="Bound">σ-eq</a> <a id="799" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="801" href="Theory.Soundness.html#801" class="Bound">ts</a><a id="803" class="Symbol">))</a> <a id="806" class="Symbol">=</a>
    <a id="812" href="Syntax.Typed.Term.html#667" class="InductiveConstructor">op</a> <a id="815" class="Symbol">(</a><a id="816" href="Theory.Soundness.html#790" class="Bound">σ</a> <a id="818" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="820" href="Theory.Soundness.html#794" class="Bound">σ-eq</a> <a id="825" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="827" href="Theory.Soundness.html#863" class="Function">soundnessᵃˢ</a> <a id="839" class="Symbol">(</a><a id="840" href="Theory.Soundness.html#115" class="Bound">BD</a> <a id="843" class="Symbol">.</a><a id="844" href="Syntax.BiTyped.Signature.html#719" class="Field">ar</a> <a id="847" href="Theory.Soundness.html#778" class="Bound">i</a> <a id="849" class="Symbol">.</a><a id="850" href="Syntax.BiTyped.Signature.html#579" class="Field">args</a><a id="854" class="Symbol">)</a> <a id="856" href="Theory.Soundness.html#801" class="Bound">ts</a><a id="858" class="Symbol">)</a>

  <a id="soundnessᵃˢ"></a><a id="863" href="Theory.Soundness.html#863" class="Function">soundnessᵃˢ</a>
    <a id="879" class="Symbol">:</a> <a id="881" class="Symbol">(</a><a id="882" href="Theory.Soundness.html#882" class="Bound">Ds</a> <a id="885" class="Symbol">:</a> <a id="887" href="Syntax.BiTyped.Signature.html#446" class="Function">ArgsD</a> <a id="893" href="Theory.Soundness.html#543" class="Generalizable">Ξ</a><a id="894" class="Symbol">)</a> <a id="896" class="Symbol">{</a><a id="897" href="Theory.Soundness.html#897" class="Bound">rs</a> <a id="900" class="Symbol">:</a> <a id="902" href="Syntax.Typed.Raw.Functor.html#364" class="Function Operator">R.⟦</a> <a id="906" href="Theory.Erasure.html#277" class="Function">eraseᵃˢ</a> <a id="914" href="Theory.Soundness.html#882" class="Bound">Ds</a> <a id="917" href="Syntax.Typed.Raw.Functor.html#364" class="Function Operator">⟧ᵃˢ</a> <a id="921" href="Syntax.Typed.Raw.Term.html#286" class="Datatype">Raw</a> <a id="925" class="Symbol">(</a><a id="926" href="Data.List.Base.html#5067" class="Function">length</a> <a id="933" href="Theory.Soundness.html#551" class="Generalizable">Γ</a><a id="934" class="Symbol">)}</a> <a id="937" class="Symbol">{</a><a id="938" href="Theory.Soundness.html#938" class="Bound">σ</a> <a id="940" class="Symbol">:</a> <a id="942" href="Syntax.Simple.html#200" class="Function">TSub</a> <a id="947" href="Theory.Soundness.html#543" class="Generalizable">Ξ</a> <a id="949" class="Number">0</a><a id="950" class="Symbol">}</a>
    <a id="956" class="Symbol">→</a> <a id="958" href="Syntax.BiTyped.Functor.html#733" class="Function Operator">⟦</a> <a id="960" href="Theory.Soundness.html#882" class="Bound">Ds</a> <a id="963" href="Syntax.BiTyped.Functor.html#733" class="Function Operator">⟧ᵃˢ</a> <a id="967" href="Syntax.Typed.Raw.Term.html#286" class="Datatype">Raw</a> <a id="971" href="Syntax.BiTyped.Term.html#630" class="Datatype Operator">_⊢_[_]_</a> <a id="979" href="Theory.Soundness.html#938" class="Bound">σ</a> <a id="981" href="Theory.Soundness.html#551" class="Generalizable">Γ</a> <a id="983" href="Theory.Soundness.html#897" class="Bound">rs</a>
    <a id="990" class="Symbol">→</a> <a id="992" href="Syntax.Typed.Functor.html#690" class="Function Operator">T.⟦</a> <a id="996" href="Theory.Erasure.html#277" class="Function">eraseᵃˢ</a> <a id="1004" href="Theory.Soundness.html#882" class="Bound">Ds</a> <a id="1007" href="Syntax.Typed.Functor.html#690" class="Function Operator">⟧ᵃˢ</a> <a id="1011" href="Syntax.Typed.Raw.Term.html#286" class="Datatype">Raw</a> <a id="1015" href="Syntax.Typed.Term.html#434" class="Datatype Operator">_⊢_⦂_</a> <a id="1021" href="Theory.Soundness.html#938" class="Bound">σ</a> <a id="1023" href="Theory.Soundness.html#551" class="Generalizable">Γ</a> <a id="1025" href="Theory.Soundness.html#897" class="Bound">rs</a>
  <a id="1030" href="Theory.Soundness.html#863" class="Function">soundnessᵃˢ</a> <a id="1042" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>                  <a id="1062" class="Symbol">_</a>        <a id="1071" class="Symbol">=</a> <a id="1073" href="Prelude.html#3623" class="InductiveConstructor">tt</a>
  <a id="1078" href="Theory.Soundness.html#863" class="Function">soundnessᵃˢ</a> <a id="1090" class="Symbol">((</a><a id="1092" href="Theory.Soundness.html#1092" class="Bound">Δ</a> <a id="1094" href="Syntax.BiTyped.Signature.html#371" class="InductiveConstructor Operator">⊢[</a> <a id="1097" class="Symbol">_</a> <a id="1099" href="Syntax.BiTyped.Signature.html#371" class="InductiveConstructor Operator">]</a> <a id="1101" class="Symbol">_)</a> <a id="1104" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1106" href="Theory.Soundness.html#1106" class="Bound">Ds</a><a id="1108" class="Symbol">)</a> <a id="1110" class="Symbol">(</a><a id="1111" href="Theory.Soundness.html#1111" class="Bound">t</a> <a id="1113" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1115" href="Theory.Soundness.html#1115" class="Bound">ts</a><a id="1117" class="Symbol">)</a> <a id="1119" class="Symbol">=</a> <a id="1121" href="Theory.Soundness.html#1159" class="Function">soundnessᵃ</a> <a id="1132" href="Theory.Soundness.html#1092" class="Bound">Δ</a> <a id="1134" href="Theory.Soundness.html#1111" class="Bound">t</a> <a id="1136" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1138" href="Theory.Soundness.html#863" class="Function">soundnessᵃˢ</a> <a id="1150" href="Theory.Soundness.html#1106" class="Bound">Ds</a> <a id="1153" href="Theory.Soundness.html#1115" class="Bound">ts</a>

  <a id="soundnessᵃ"></a><a id="1159" href="Theory.Soundness.html#1159" class="Function">soundnessᵃ</a>
    <a id="1174" class="Symbol">:</a> <a id="1176" class="Symbol">(</a><a id="1177" href="Theory.Soundness.html#1177" class="Bound">Δ</a> <a id="1179" class="Symbol">:</a> <a id="1181" href="Syntax.Simple.html#181" class="Function">TExps</a> <a id="1187" href="Theory.Soundness.html#543" class="Generalizable">Ξ</a><a id="1188" class="Symbol">)</a> <a id="1190" class="Symbol">{</a><a id="1191" href="Theory.Soundness.html#1191" class="Bound">r</a> <a id="1193" class="Symbol">:</a> <a id="1195" href="Syntax.Typed.Raw.Functor.html#295" class="Function Operator">R.⟦</a> <a id="1199" href="Theory.Soundness.html#1177" class="Bound">Δ</a> <a id="1201" href="Syntax.Typed.Raw.Functor.html#295" class="Function Operator">⟧ᵃ</a> <a id="1204" href="Syntax.Typed.Raw.Term.html#286" class="Datatype">Raw</a> <a id="1208" class="Symbol">(</a><a id="1209" href="Data.List.Base.html#5067" class="Function">length</a> <a id="1216" href="Theory.Soundness.html#551" class="Generalizable">Γ</a><a id="1217" class="Symbol">)}</a> <a id="1220" class="Symbol">{</a><a id="1221" href="Theory.Soundness.html#1221" class="Bound">σ</a> <a id="1223" class="Symbol">:</a> <a id="1225" href="Syntax.Simple.html#200" class="Function">TSub</a> <a id="1230" href="Theory.Soundness.html#543" class="Generalizable">Ξ</a> <a id="1232" class="Number">0</a><a id="1233" class="Symbol">}</a>
    <a id="1239" class="Symbol">→</a> <a id="1241" href="Syntax.BiTyped.Functor.html#509" class="Function Operator">⟦</a> <a id="1243" href="Theory.Soundness.html#1177" class="Bound">Δ</a> <a id="1245" href="Syntax.BiTyped.Functor.html#509" class="Function Operator">⟧ᵃ</a>   <a id="1250" href="Syntax.Typed.Raw.Term.html#286" class="Datatype">Raw</a> <a id="1254" class="Symbol">(</a><a id="1255" href="Syntax.BiTyped.Term.html#630" class="Datatype Operator">_⊢_[</a> <a id="1260" href="Theory.Soundness.html#575" class="Generalizable">d</a> <a id="1262" href="Syntax.BiTyped.Term.html#630" class="Datatype Operator">]</a> <a id="1264" href="Theory.Soundness.html#586" class="Generalizable">A</a><a id="1265" class="Symbol">)</a> <a id="1267" href="Theory.Soundness.html#1221" class="Bound">σ</a> <a id="1269" href="Theory.Soundness.html#551" class="Generalizable">Γ</a> <a id="1271" href="Theory.Soundness.html#1191" class="Bound">r</a>
    <a id="1277" class="Symbol">→</a> <a id="1279" href="Syntax.Typed.Functor.html#466" class="Function Operator">T.⟦</a> <a id="1283" href="Theory.Soundness.html#1177" class="Bound">Δ</a> <a id="1285" href="Syntax.Typed.Functor.html#466" class="Function Operator">⟧ᵃ</a> <a id="1288" href="Syntax.Typed.Raw.Term.html#286" class="Datatype">Raw</a> <a id="1292" class="Symbol">(</a><a id="1293" href="Syntax.Typed.Term.html#434" class="Datatype Operator">_⊢_⦂</a> <a id="1298" href="Theory.Soundness.html#586" class="Generalizable">A</a><a id="1299" class="Symbol">)</a>     <a id="1305" href="Theory.Soundness.html#1221" class="Bound">σ</a> <a id="1307" href="Theory.Soundness.html#551" class="Generalizable">Γ</a> <a id="1309" href="Theory.Soundness.html#1191" class="Bound">r</a>
  <a id="1313" href="Theory.Soundness.html#1159" class="Function">soundnessᵃ</a> <a id="1324" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>      <a id="1332" href="Theory.Soundness.html#1332" class="Bound">t</a> <a id="1334" class="Symbol">=</a> <a id="1336" href="Theory.Soundness.html#604" class="Function">soundness</a>    <a id="1349" href="Theory.Soundness.html#1332" class="Bound">t</a>
  <a id="1353" href="Theory.Soundness.html#1159" class="Function">soundnessᵃ</a> <a id="1364" class="Symbol">(_</a> <a id="1367" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1369" href="Theory.Soundness.html#1369" class="Bound">Δ</a><a id="1370" class="Symbol">)</a> <a id="1372" href="Theory.Soundness.html#1372" class="Bound">t</a> <a id="1374" class="Symbol">=</a> <a id="1376" href="Theory.Soundness.html#1159" class="Function">soundnessᵃ</a> <a id="1387" href="Theory.Soundness.html#1369" class="Bound">Δ</a> <a id="1389" href="Theory.Soundness.html#1372" class="Bound">t</a>
</pre></body></html>