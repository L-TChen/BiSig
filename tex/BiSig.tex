\documentclass[acmsmall,screen]{acmart}

\ifPDFTeX
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\else
\usepackage{polyglossia}
\setdefaultlanguage{british}
\fi

\usepackage{bm}
\usepackage{mathtools}
\usepackage{mathpartir}
\input{mathlig}
%\usepackage{xfrac}
\usepackage{xspace}
%\usepackage{hyperref}
\usepackage[capitalise,noabbrev]{cleveref}

%\usepackage[inline]{enumitem} % for environment enumerate*
%\setlist[enumerate]{mode=unboxed}

\setlength {\marginparwidth }{2cm}
\usepackage[color=yellow,textsize=small]{todonotes}

\usepackage{microtype}

\citestyle{acmauthoryear}
\AtEndPreamble{%
\theoremstyle{acmdefinition}
\newtheorem{remark}[theorem]{Remark}}

\input{type-notation} %% for type theory notation copied from HoTT Book
\input{macros}

\newcommand{\LT}[1]{\todo[author=LT,inline,color=green!40,caption={}]{{#1}}}
\newcommand{\Josh}[1]{\todo[author=Josh,inline,color=green!40,caption={}]{{#1}}}

\begin{document}

\author{Liang-Ting Chen}
\email{liang.ting.chen.tw@gmail.com}
\orcid{0000-0002-3250-1331}
\author{Hsiang-Shang Ko}
\orcid{0000-0002-2439-1048}
\email{joshko@iis.sinica.edu.tw}

\affiliation{%
  \institution{Academia Sinica}
  \streetaddress{128 Academia Road}
  \city{Taipei}
  \country{Taiwan}
  \postcode{115}
}

\title{A Theory of Bidirectional Type Synthesis for Simple Types}

\begin{abstract}
  Type checking and inference serve as the passage from parsed abstract syntax trees to well-typed programs.
  While significant progress has been made in developing techniques for typechecking advanced type systems on a case-by-case basis, the lack of a general theory poses a difficulty of achieving a robust `type checker generator' for diverse programming languages.

  Motivated by this problem, this paper develops a \emph{general} and \emph{constructive} theory of bidirectional type synthesis where bidirectional type synthesis refers to the mutual use of type checking and inference based on bidirectional typing rules for synthesising the type of a programs possibly with type annotations.
%  Bidirectional typing had only been a set of principles and characteristics to design typing rules so that a type synthesis algorithm can be `read off' easily
  First, our theory is general as it deals with any simple type theory and its bidirectional type system that can be specified by some bidirectional binding signature, similar to the role of grammar in parsing.
  Second, our theory is constructive because properties are not only formalised in Martin-L\"{o}f's type theory, \Agda, but also formulated from the practical aspect in order to compute.
  Specifically, we prove logical decidability of type synthesis for any mode-correct signature, subsuming soundness, completeness, and decidability of type synthesis algorithm.
  For a given (mode-correct) signature, its proof is instantiated to a synthesiser specific to the corresponding simple type theory, similar to a parser generator.
  A simple notion called bidirectionalisation is proposed to refine an essential characteristic of bidirectional typing called annotability.
  This notion leads to the trichotomy of raw terms whose proof models a practical type synthesiser that handles ill-formed inputs, including raw terms with missing type annotations.

  In short, this paper is a small but first step towards a general theory of type checking and inference.
  By formalizing our theory of bidirectional type synthesise in \Agda, we provide a framework capable of handling bidirectional type systems of simple types uniformly.
  Our work addresses the problem with existing methodologies, setting the stage for further advances towards a more general theory of type synthesis.
\end{abstract}

\begin{CCSXML}
<ccs2012>
   <concept>
       <concept_id>10011007.10011006.10011041</concept_id>
       <concept_desc>Software and its engineering~Compilers</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10011007.10011006.10011039.10011040</concept_id>
       <concept_desc>Software and its engineering~Syntax</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10011007.10011074.10011099.10011692</concept_id>
       <concept_desc>Software and its engineering~Formal software verification</concept_desc>
       <concept_significance>300</concept_significance>
       </concept>
   <concept>
       <concept_id>10003752.10003790.10011740</concept_id>
       <concept_desc>Theory of computation~Type theory</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
 </ccs2012>
\end{CCSXML}

\ccsdesc[500]{Software and its engineering~Compilers}
\ccsdesc[500]{Software and its engineering~Syntax}
\ccsdesc[500]{Theory of computation~Type theory}
\ccsdesc[300]{Software and its engineering~Formal software verification}

\keywords{\Agda, abstract syntax, bidirectional typing, type synthesis, type checking, type inference, language formalisation}

\maketitle

\input{sec1-intro}
\input{sec2-outline}
\input{sec3-defs.tex}
\input{sec4-bidirectionalisation.tex}
\input{sec5-synthesis.tex}
\input{sec6-formalisation.tex}
\input{sec7-future.tex}

\begin{acks}
We thank Nathanael Arkor for the useful conversation and to thank the Programming Languages and Formal Methods Laboratory at Academia Sinica for the opportunity of sharing earlier ideas.

The work is supported by the Ministry of Science and Technology of Taiwan under grant MOST 109-2222-E-001-002-MY3.
\end{acks}

\bibliographystyle{ACM-Reference-Format}

\IfFileExists{reference.bib}{%
  \bibliography{reference}
}{\bibliography{ref}}

\end{document}
