\documentclass[acmsmall,screen]{acmart}

\ifPDFTeX
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\else
\usepackage{polyglossia}
\setdefaultlanguage{british}
\fi

\usepackage{bm}
\usepackage{mathtools}
\usepackage{mathpartir}
\input{mathlig}
%\usepackage{xfrac}
\usepackage{xspace}
%\usepackage{hyperref}
\usepackage[capitalise,noabbrev]{cleveref}

%\usepackage[inline]{enumitem} % for environment enumerate*
%\setlist[enumerate]{mode=unboxed}

\setlength {\marginparwidth }{2cm}
\usepackage[color=yellow,textsize=small]{todonotes}

\usepackage{microtype}

\citestyle{acmauthoryear}
\AtEndPreamble{%
\theoremstyle{acmdefinition}
\newtheorem{remark}[theorem]{Remark}}

\input{type-notation} %% for type theory notation copied from HoTT Book
\input{macros}

\newcommand{\LT}[1]{\todo[author=LT,inline,color=green!40,caption={}]{{#1}}}
\newcommand{\Josh}[1]{\todo[author=Josh,inline,color=green!40,caption={}]{{#1}}}

\begin{document}

\author{Liang-Ting Chen}
\email{liang.ting.chen.tw@gmail.com}
\orcid{0000-0002-3250-1331}
\author{Hsiang-Shang Ko}
\orcid{0000-0002-2439-1048}
\email{joshko@iis.sinica.edu.tw}

\affiliation{%
  \institution{Academia Sinica}
  \streetaddress{128 Academia Road}
  \city{Taipei}
  \country{Taiwan}
  \postcode{115}
}

\title{A Theory of Bidirectional Type Synthesis for Simple Types}

\begin{abstract}
%  Type checking (and inference) can be seen as the transition from parsed abstract syntax trees to well-typed programs.
%  Many techniques and principles have been developed to type check advanced type theories and systems.
%  However, as theory and practice of parsing are able to address common grammars uniformly and parser generators have existed, type checkers by now are still designed and implemented on a case-by-case basis, not to mention a general theory of type checking and a robust `type checker generator' that can handle languages uniformly.
%
%  This paper is a step towards a \emph{general theory} of type checking and inference.
%  Inspired by recent language-formalisation frameworks, we theroise bidirectional typing---a design discipline of type synthesis mutually defining type checking and inference---for \emph{arbitrary} bidirectional type systems specified by a bidirectional binding signature and also formalise the theory in vanilla \Agda with Axiom K.
%  Prominently, our theorems including decidability of type synthesis are sound and complete type synthesisers which are correct by construction.
  Type checking and inference serve as the passage from parsed abstract syntax trees to well-typed programs.
  While significant progress has been made in developing techniques for type checking advanced type systems on a case-by-case basis, the lack of a general theory and a robust `type checker generator' poses a challenge to achieving uniformity across diverse programming languages.

  Motivated by this challenge, this paper contributes to the development of a general and practical theory of type checking and inference.
  First, we present a \emph{general} theory of bidirectional typing, which had only been a design discipline, to synthesise types for \emph{syntax-directed} bidirectional type systems of \emph{simple types}.
  Here, \emph{(bidirectional) type synthesis} refers to the mutual use of type checking and inference to synthesise the type of a programs possibly with type annotations.
  Second, our theory is \emph{practical} not only because we formalize our theory in \Agda but also we have formulated our results from the practical aspect to provide useful computational meaning.
  Specifically, we prove \emph{logical decidability} of type synthesis, subsuming soundness, completeness, and decidability of type synthesis algorithm; by Curry-Howard correspondence, our proof is a correct-by-construction synthesiser.
  Also we discuss an essential characteristic of bidirectional typing called \emph{annotability} and propose a related but simpler and practical replacement called \emph{bidirectionalisation}.
  Combining with decidability of type synthesis, we derive the trichotomy of raw terms whose proof is a type synthesiser which distinguishes raw terms with missing type annotations from those that cannot be checked.

  In short, this paper is a first step towards a general and practical theory of type checking and inference.
  By formalizing our theory of bidirectional type synthesise in \Agda, we provide a framework capable of handling bidirectional type systems of simple types.
  Our work addresses the problem with existing methodologies, setting the stage for further advances towards a general theory of type synthesis.
\end{abstract}

\keywords{\Agda, abstract syntax, bidirectional typing, type synthesis, type checking, type inference, language formalisation}

\maketitle

\input{sec1-intro}
\input{sec2-outline}
\input{sec3-defs.tex}
\input{sec4-bidirectionalisation.tex}
\input{sec5-synthesis.tex}
\input{sec6-formalisation.tex}
\input{sec7-future.tex}

\begin{acks}
We thank Nathanael Arkor for the useful conversation and to thank the Programming Languages and Formal Methods Laboratory at Academia Sinica for the opportunity of sharing earlier ideas.

The work is supported by the Ministry of Science and Technology of Taiwan under grant MOST 109-2222-E-001-002-MY3.
\end{acks}

\bibliographystyle{ACM-Reference-Format}

\IfFileExists{reference.bib}{%
  \bibliography{reference}
}{\bibliography{ref}}

\end{document}
