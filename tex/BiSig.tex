\documentclass[acmsmall,screen]{acmart}

\ifPDFTeX
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\else
\usepackage{polyglossia}
\setdefaultlanguage{british}
\fi

\usepackage{bm}
\usepackage{mathtools}
\usepackage{mathpartir}
\input{mathlig}
%\usepackage{xfrac}
\usepackage{xspace}
%\usepackage{hyperref}
\usepackage[capitalise,noabbrev]{cleveref}

%\usepackage[inline]{enumitem} % for environment enumerate*
%\setlist[enumerate]{mode=unboxed}

\setlength {\marginparwidth }{2cm}
\usepackage[color=yellow,textsize=small]{todonotes}

\usepackage{microtype}

\citestyle{acmauthoryear}
\AtEndPreamble{%
\theoremstyle{acmdefinition}
\newtheorem{remark}[theorem]{Remark}}

\input{type-notation} %% for type theory notation copied from HoTT Book
\input{macros}

\newcommand{\LT}[1]{\todo[author=LT,inline,color=green!40,caption={}]{{#1}}}
\newcommand{\Josh}[1]{\todo[author=Josh,inline,color=green!40,caption={}]{{#1}}}

\begin{document}

\author{Liang-Ting Chen}
\email{liang.ting.chen.tw@gmail.com}
\orcid{0000-0002-3250-1331}
\author{Hsiang-Shang Ko}
\orcid{0000-0002-2439-1048}
\email{joshko@iis.sinica.edu.tw}

\affiliation{%
  \institution{Academia Sinica}
  \streetaddress{128 Academia Road}
  \city{Taipei}
  \country{Taiwan}
  \postcode{115}
}

\title{A Theory of Bidirectional Type Synthesis for Simple Types}

\begin{abstract}
  Type checking and inference serve as the passage from parsed abstract syntax trees to well-typed programs.
  While progress has been made in developing techniques for typechecking on a case-by-case basis, the lack of a general theory poses a difficulty of implementing a robust `type checker generator' for diverse languages.

  Motivated by this issue, we develop a \emph{simple} but \emph{general} and \emph{constructive} theory of bidirectional type synthesis where bidirectional type synthesis refers to the mutual use of type checking and inference based on bidirectional typing rules for synthesising the type of a program with type annotations.
  First, our theory is simple but general as it deals with any simple type theory and its bidirectional type system that can be specified by a signature, analogous to the role of grammar in parsing.
  Second, our theory is constructive because it is not only formalised in a proof assistant based on constructive type theory but also formulated positively in order to compute.
  Specifically, a type synthesiser for a simple type theory specified by some mode-correct signature is the proof of logical decidability of synthesis, analogous to a parser generator.
  The notion of bidirectionalisation is introduced to refine annotability in bidirectional typing.
  Type synthesis and bidirectionalisation lead to the trichotomy of raw terms which models a practical type synthesiser that throws an exception when its input does not have enough annotations potentially with a proof to locate missing annotations.
  Hence, by formalizing our general theory of bidirectional type synthesis constructively, we provide a provably correct `type checker generator' for simple type theories, setting the stage for further advances towards a more general theory of type synthesis.
\end{abstract}

\begin{CCSXML}
<ccs2012>
   <concept>
       <concept_id>10011007.10011006.10011041</concept_id>
       <concept_desc>Software and its engineering~Compilers</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10011007.10011006.10011039.10011040</concept_id>
       <concept_desc>Software and its engineering~Syntax</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10011007.10011074.10011099.10011692</concept_id>
       <concept_desc>Software and its engineering~Formal software verification</concept_desc>
       <concept_significance>300</concept_significance>
       </concept>
   <concept>
       <concept_id>10003752.10003790.10011740</concept_id>
       <concept_desc>Theory of computation~Type theory</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
 </ccs2012>
\end{CCSXML}

\ccsdesc[500]{Software and its engineering~Compilers}
\ccsdesc[500]{Software and its engineering~Syntax}
\ccsdesc[500]{Theory of computation~Type theory}
\ccsdesc[300]{Software and its engineering~Formal software verification}

\keywords{\Agda, abstract syntax, bidirectional typing, type synthesis, type checking, type inference, language formalisation, datatype-generic programming}

\maketitle

\input{sec1-intro}
\input{sec2-outline}
\input{sec3-defs.tex}
\input{sec4-bidirectionalisation.tex}
\input{sec5-synthesis.tex}
\input{sec6-formalisation.tex}
\input{sec7-future.tex}

\begin{acks}
We thank Nathanael Arkor for the useful conversation and to thank the Programming Languages and Formal Methods Laboratory at Academia Sinica for the opportunity of sharing earlier ideas.

The work is supported by the Ministry of Science and Technology of Taiwan under grant MOST 109-2222-E-001-002-MY3.
\end{acks}

\bibliographystyle{ACM-Reference-Format}

\IfFileExists{reference.bib}{%
  \bibliography{reference}
}{\bibliography{ref}}

\end{document}
