\documentclass[envcountsect,runningheads,a4paper]{llncs}

\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage{cite}
\usepackage{amsmath}
\usepackage{xifthen,xspace,xcolor}
\usepackage[colorlinks=true,allcolors=black]{hyperref}
%\usepackage[hyperpageref]{backref}
\usepackage[capitalise,noabbrev]{cleveref}
\usepackage[color=yellow,textsize=footnotesize,prependcaption,obeyFinal]{todonotes}
\usepackage[inline]{enumitem} % for environment enumerate*
\usepackage{bussproofs}
\EnableBpAbbreviations
\usepackage[all,cmtip]{xy}
\usepackage{mathtools}
\usepackage{microtype}

\input{macros}

\title{From Binding Signatures to Bidirectional Typing}
\author{Liang-Ting Chen\orcidID{0000-0002-3250-1331} \and Hsiang-Shang Ko\orcidID{0000-0002-2439-1048}}
\authorrunning{L.-T.\ Chen and H.-S.\ Ko}
\institute{Institute of Information Science, Academia Sinica, Taiwan}

\begin{document}

\maketitle

\begin{abstract}
  Formalising an abstract (typed) syntax with variable binding to reason about typically starts from the boilerplate of definitions for substitution along with its metatheory, stimulating a number of language-formalisation frameworks:
  Given the presentation of a syntax in such a framework, a type of terms with recursion principle(s) and its metatheory will be instantiated, removing the burden of repeating the boilerplate.
  However, the metatheory of substitution is only the tip of the iceberg.

  In this paper, we extend the scope to bidirectional typing which is used for designing type checking algorithms.
  First, we adopt the notion of binding signatures to bidirectional type systems which allows us to formally specify and reason about criteria such as soundness, annotatability, and mode-correctness.
  Contrast to many frameworks, we emphasise the use of the extrinsic representation and implement a proof-relevant type checker for mode-correct bidirectional type systems in \Agda.
  This extension amounts to a type checker generator for simple type systems, 
  filling the gap between parser generator and language formalisation.
  \keywords{binding signature \and bidirectional typing \and initial semantics \and abstract syntax \and type checking \and language formalisation \and \Agda}
\end{abstract}

\section{Introduction}
\todo{abbreviate \emph{abstract (typed) syntax with variable binding} to \emph{(typed) language})}
\section{Initial Semantics of Syntax with Variable Binding}
\section{Extrinsically-Typed Representation}
\section{Binding Signature for Bidirectional Typing}
\section{Bidirectional Type Checking}
\section{Discussion}

\paragraph{Bidirectional typing}
\cite{Pierce2000a,Dunfield2021}

\paragraph{Universal theories of abstract syntax with variable binding} have been studied and proposed via various approaches over a few decades.
Herein we are interested in the category-theoretic approaches---particuarly \emph{the initisl semantics}---since they appear to be the most flexible and free from design choices if implemented properly (see below).
The initial semantics~\cite{Fiore1999} initiates from the observation that the family of scoped terms as an indexed set equipped with renaming has a $\Sigma$-monoid structure: substitution is monoidal and syntax constructs form an algebra for an endo-functor $\Sigma$ in the category of presheaves on contexts.

\todo{Heterogeneous substitution systems\cite{Matthes2004,Ahrens2018b}}
\todo{Modules over monads \cite{Hirschowitz2010}}
\todo{\cite{Hirschowitz2022}}

The idea of including the presentation as well as the language itself appeared earlier~\cite{Hamana2011a,Fiore2013a,Arkor2020} and is essential for our development, since we need to recognise type variables in the binding signature for defining mode-correctness.


\paragraph{Language-formalisation frameworks} have been implemented in proof assistants and vary in design choices including the binding representation paradigm, the language presentation, how the formal syntax is instantiated, and more.
Due to the limited space we will only discuss frameworks that are somewhat of different characteristics.
Nevertheless, the interested reader is referred to the discussion by Gheri and Popescu~\cite[Section 8]{Gheri2020} for a more comprehensive list of frameworks.

Among the plethora of choices, the formalisation of the category-theoretic approach based on (coalgebraic) $\Sigma$-monoids with metavariable~\cite{Fiore2008} by Fiore and Szamozvancev~\cite{Fiore2022} provides a metatheory independent of the aforementioned design choices whereas, instead of having the formal metatheory bolted on to a set of chosen paradigms, they only presume the property of a language to satisfy, i.e.\ the \emph{initiality}, offering a greater flexibility.
Another frameworks based on the category-theoretic notion of heterogeneous substitution systems are implemented by Ahrens et al.~\cite{Ahrens2018,Ahrens2022}
As we focus on the presentation of bidirectional typing, the category-theoretic approach is orthogonal to our interest.
Having said that, we have organised the underlying theory using category theory, hoping to integrate our development with the category-theoretic frameworks in future.

Our work is especially inspired by Allais et al.~\cite{Allais2021}
They demonstrated a number of generic programs and `meta-meta-properties' including term printing, scope checking, simulation lemma (strong normaliation via logical relation as an instance), and fusion lemma (Substitution Lemma~\cite{Mitchell1991a} as an instance) for languages expressible in their framework.
They also implemented a bidirectional type checker but for simply typed lambda calculus only.



\subsubsection*{Acknowledgements}
We thank Nathanael Arkor for the useful conversion over Twitter and to thank the Programming Languages and Formal Methods Laboratory at Academia Sinica for the opportunity of sharing earlier ideas.

The work is supported by the Ministry of Science and Technology of Taiwan under grant MOST 109-2222-E-001-002-MY3.
 
\bibliographystyle{splncs04}
\bibliography{ref}
%\bibliography{library}
\end{document}
